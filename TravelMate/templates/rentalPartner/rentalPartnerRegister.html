<!DOCTYPE html>
{% load static %}
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Rental Partner Registration | TravelMate</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Google Font -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: "Poppins", sans-serif;
            background: linear-gradient(135deg, #eef2ff, #fff1f2);
        }

        .preview-box {
            width: 100%;
            height: 150px;
            border: 2px dashed #c4c4c4;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            background: #fafafa;
            transition: 0.3s;
            cursor: pointer;
        }

        .preview-box:hover {
            border-color: #6366f1;
        }

        .preview-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: none;
        }

        .alert-hide {
            opacity: 0;
            transition: opacity 0.5s ease-out;
        }

        .input-error {
            border-color: #ef4444 !important;
        }
    </style>
</head>

<body class="min-h-screen flex justify-center items-center p-6">

    <div class="bg-white w-full max-w-3xl p-8 rounded-2xl shadow-xl">
<!-- üîî PROFESSIONAL MESSAGES -->
{% if messages %}
<div class="mb-6 space-y-4">
  {% for message in messages %}
    <div class="flex items-start gap-3 p-4 rounded-xl shadow-sm border text-sm font-medium
      {% if message.tags == 'success' %}
        bg-green-50 text-green-800 border-green-200
      {% elif message.tags == 'error' %}
        bg-red-50 text-red-800 border-red-200
      {% elif message.tags == 'warning' %}
        bg-yellow-50 text-yellow-800 border-yellow-200
      {% else %}
        bg-blue-50 text-blue-800 border-blue-200
      {% endif %}
    ">

      <!-- Icon -->
      <div>
        {% if message.tags == 'success' %}
          ‚úÖ
        {% elif message.tags == 'error' %}
          ‚ùå
        {% elif message.tags == 'warning' %}
          ‚ö†
        {% else %}
          ‚Ñπ
        {% endif %}
      </div>

      <!-- Message Text -->
      <div class="flex-1">
        {{ message }}
      </div>

    </div>
  {% endfor %}
</div>
{% endif %}

        <h1 class="text-2xl font-semibold text-indigo-600 text-center mb-6">
            Rental Partner Registration
        </h1>

        <form id="partnerForm" method="POST" enctype="multipart/form-data"
              class="grid grid-cols-1 md:grid-cols-2 gap-6">

            {% csrf_token %}

            <div>
                <label class="font-medium">Full Name *</label>
                <input type="text" name="name" required class="input">
            </div>

            <div>
                <label class="font-medium">Email *</label>
                <input type="email" name="email" required class="input">
            </div>

            <div>
                <label class="font-medium">Password *</label>
                <input type="password" id="password" name="password" required minlength="6" class="input">
            </div>

            <div>
                <label class="font-medium">Confirm Password *</label>
                <input type="password" id="confirm_password" name="confirm_password" required class="input">
                <p id="passwordError" class="text-red-500 text-xs mt-1 hidden">Passwords do not match</p>
            </div>

            <div>
                <label class="font-medium">Mobile Number *</label>
                <input type="text" id="mobileNumber" name="mobileNumber" required maxlength="10" class="input">
                <p id="mobileError" class="text-red-500 text-xs mt-1 hidden">Enter a valid 10-digit number</p>
            </div>

            <div>
                <label class="font-medium">Aadhaar Number *</label>
                <input type="text" id="aadharId" name="aadharId" required maxlength="12" class="input">
                <p id="aadharError" class="text-red-500 text-xs mt-1 hidden">Enter a valid 12-digit Aadhaar</p>
            </div>

            <div>
                <label class="font-medium">Company Name (optional)</label>
                <input type="text" name="combanyName" class="input">
            </div>

            <div>
                <label class="font-medium">GST Number (optional)</label>
                <input type="text" name="GST_number" class="input">
            </div>

            <div>
                <label class="font-medium">City</label>
                <input type="text" name="city" class="input">
            </div>

            <div>
                <label class="font-medium">State</label>
                <input type="text" name="state" class="input">
            </div>

            <div class="md:col-span-2">
                <label class="font-medium">Full Address</label>
                <textarea name="Address" rows="3" class="input"></textarea>
            </div>

             <div>
                <label class="font-medium">location</label>
                <input type="text" name="location" class="input">
            </div>

            <!-- Aadhaar Image -->
            <div>
                <label class="font-medium">Aadhaar Image *</label>

                <div class="preview-box" id="aadharPreviewBox">
                    <img id="aadharPreview" class="preview-img">
                    <span class="text-gray-400 text-sm">Click to upload</span>
                </div>

                <input type="file" id="aadharInput" name="aadharImage" required
                       accept="image/*" class="hidden">
            </div>

            <!-- Shop Image -->
            <div>
                <label class="font-medium">Shop Image (optional)</label>

                <div class="preview-box" id="shopPreviewBox">
                    <img id="shopPreview" class="preview-img">
                    <span class="text-gray-400 text-sm">Click to upload</span>
                </div>

                <input type="file" id="shopInput" name="shopImage"
                       accept="image/*" class="hidden">
            </div>

            <div class="md:col-span-2">
                <button type="submit"
                    class="w-full bg-indigo-600 text-white py-3 rounded-xl text-lg font-medium hover:bg-indigo-700">
                    Register
                </button>
            </div>

        </form>
    </div>

    <style>
        .input {
            width: 100%;
            padding: 10px;
            margin-top: 4px;
            border-radius: 8px;
            border: 1px solid #d1d5db;
        }
    </style>

    <script>
        const form = document.getElementById("partnerForm");

        const pass = document.getElementById("password");
        const cpass = document.getElementById("confirm_password");
        const passError = document.getElementById("passwordError");

        const mobile = document.getElementById("mobileNumber");
        const mobileError = document.getElementById("mobileError");

        const aadhar = document.getElementById("aadharId");
        const aadharError = document.getElementById("aadharError");


        // IMAGE CLICK HANDLER
        document.getElementById("aadharPreviewBox").onclick = () =>
            document.getElementById("aadharInput").click();

        document.getElementById("shopPreviewBox").onclick = () =>
            document.getElementById("shopInput").click();


        // IMAGE PREVIEW
        function previewImage(input, preview) {
            input.addEventListener("change", () => {
                const file = input.files[0];
                if (!file) return;

                const img = document.getElementById(preview);
                img.src = URL.createObjectURL(file);
                img.style.display = "block";
                img.parentElement.querySelector("span")?.remove();
            });
        }
        previewImage(aadharInput, 'aadharPreview');
        previewImage(shopInput, 'shopPreview');


        // VALIDATION
        form.addEventListener("submit", function (e) {

            let valid = true;


            // Password Match
            if (pass.value !== cpass.value) {
                passError.classList.remove("hidden");
                pass.classList.add("input-error");
                cpass.classList.add("input-error");
                valid = false;
            } else {
                passError.classList.add("hidden");
                pass.classList.remove("input-error");
                cpass.classList.remove("input-error");
            }

            // Mobile Number
            if (mobile.value.length !== 10) {
                mobileError.classList.remove("hidden");
                mobile.classList.add("input-error");
                valid = false;
            } else {
                mobileError.classList.add("hidden");
                mobile.classList.remove("input-error");
            }

            // Aadhaar
            if (aadhar.value.length !== 12) {
                aadharError.classList.remove("hidden");
                aadhar.classList.add("input-error");
                valid = false;
            } else {
                aadharError.classList.add("hidden");
                aadhar.classList.remove("input-error");
            }


            if (!valid) e.preventDefault();
        });
    </script>

</body>
</html>
