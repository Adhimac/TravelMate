<!DOCTYPE html>
{% load static %}
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Notifications | TravelMate</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    :root {
      --primary:#1e3a8a;
      --accent-start:#ff5a5f;
      --accent-end:#ff9f43;
    }
    .btn-accent {
      background:linear-gradient(90deg,var(--accent-start),var(--accent-end));
      color:white;
    }
  </style>
</head>

<body class="bg-gray-100 text-gray-800">

<!-- HEADER -->
<header class="bg-white border-b sticky top-0 z-40">
  <div class="max-w-7xl mx-auto px-6 py-4 flex justify-between items-center">
    <a href="/" class="font-bold text-lg text-[var(--primary)]">TravelMate</a>
    <a href="/userProfile" class="text-sm text-gray-600">My Profile</a>
  </div>
</header>

<!-- PAGE CONTENT -->
<section class="max-w-4xl mx-auto px-6 py-10">

  <h1 class="text-2xl font-bold text-[var(--primary)] mb-6">
    Connection Requests
  </h1>

  <h2 class="text-xl font-semibold mb-4">Connection Requests</h2>

  {% for req in requests %}
  <div 
    class="border p-4 rounded-lg mb-3 flex justify-between items-center cursor-pointer bg-white hover:bg-gray-50 transition"
onclick="openModal(
   '{{ req.traveler.Name }}',
   '{{ req.traveler.age }}',
   '{{ req.traveler.gender }}',
   '{{ req.traveler.bio|escapejs }}',
   '{{ req.traveler.destination }}',
   '{{ req.traveler.travel_date }}',
   '{{ req.traveler.interests }}',
   '{{ req.traveler.photo.url }}'
)"

  >
    <div>
      <h3 class="font-medium">{{ req.traveler.Name }}</h3>
      <p class="text-sm text-gray-600">{{ req.message }}</p>
    </div>

    <form method="POST" action="{% url 'accept_connection' req.id %}">
      {% csrf_token %}
      <button class="px-4 py-2 bg-green-600 text-white rounded">
        Accept
      </button>
    </form>
  </div>
  {% empty %}
    <p class="text-gray-500">No new connection requests</p>
  {% endfor %}

</section>

<!-- ====================== MODAL POPUP ====================== -->
<!-- ====================== MODERN CENTERED MODAL ====================== -->
<!-- ====================== MODERN PROFILE CARD MODAL ====================== -->
<div 
  id="userModal" 
  class="fixed inset-0 hidden items-center justify-center z-50 bg-black/40 backdrop-blur-sm"
  onclick="closeModal(event)"
>
  <div
    id="modalContent"
    class="bg-white w-full max-w-2xl rounded-3xl shadow-2xl relative p-10 transform scale-90 opacity-0 transition-all duration-300"
    onclick="event.stopPropagation()"
  >

    <!-- Close button -->
    <button 
      onclick="closeModal(event)"
      class="absolute top-4 right-4 text-gray-600 hover:text-black text-3xl"
    >
      Ã—
    </button>

    <!-- TOP SECTION: Profile Image -->
    <div class="flex justify-center">
      <img 
        id="modalPhoto" 
        src="{% static 'img/defaultuser.png' %}"
        class="w-32 h-32 rounded-full object-cover shadow-md border-4 border-white"
      >
    </div>

    <!-- CONTENT -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-10 mt-6">

      <!-- LEFT SIDE: Name + Role -->
      <div>
        <h2 id="modalName" class="text-3xl font-bold text-gray-900"></h2>
        <p id="modalGender" class="text-gray-600 mt-1"></p>

        <!-- Icons (like LinkedIn, GitHub, website) -->
        <div class="flex gap-5 mt-6">

          <div class="w-14 h-14 rounded-full bg-gray-100 flex items-center justify-center shadow">
            <img src="{% static 'img/linkedin.png' %}" class="w-7">
          </div>

          <div class="w-14 h-14 rounded-full bg-gray-100 flex items-center justify-center shadow">
            <img src="{% static 'img/github.png' %}" class="w-7">
          </div>

          <div class="w-14 h-14 rounded-full bg-gray-100 flex items-center justify-center shadow">
            <img src="{% static 'img/web.png' %}" class="w-7">
          </div>

        </div>
      </div>

      <!-- RIGHT SIDE: Bio -->
      <div>
        <p class="font-semibold text-gray-700">Bio</p>
        <p id="modalBio" class="text-gray-600 leading-relaxed"></p>

        <p class="font-semibold text-gray-700 mt-4">Destination</p>
        <p id="modalDestination" class="text-gray-600"></p>

        <p class="font-semibold text-gray-700 mt-4">Travel Date</p>
        <p id="modalDate" class="text-gray-600"></p>
      </div>
    </div>

    <!-- BUTTON -->
    <div class="mt-10 flex justify-center">
      <button class="px-10 py-3 bg-emerald-600 hover:bg-emerald-700 text-white font-semibold rounded-full shadow-lg">
        CONNECT
      </button>
    </div>

  </div>
</div>


<!-- ====================== MODAL SCRIPT WITH MODERN ANIMATION ====================== -->
<script>
function openModal(name, age, gender, bio, destination, date, interests, photo) {
  document.getElementById("modalName").innerText = name;
  document.getElementById("modalGender").innerText = gender;
  document.getElementById("modalBio").innerText = bio;
  document.getElementById("modalDestination").innerText = destination;
  document.getElementById("modalDate").innerText = date;
  document.getElementById("modalPhoto").src = photo || "/static/img/defaultuser.png";

  const modal = document.getElementById("userModal");
  const content = document.getElementById("modalContent");

  modal.classList.remove("hidden");
  modal.classList.add("flex");

  setTimeout(() => {
    content.classList.remove("scale-90", "opacity-0");
    content.classList.add("scale-100", "opacity-100");
  }, 10);
}
function closeModal(event) {
  event.stopPropagation();
  const modal = document.getElementById("userModal");
  const content = document.getElementById("modalContent");

  content.classList.remove("scale-100", "opacity-100");
  content.classList.add("scale-90", "opacity-0");

  setTimeout(() => {
    modal.classList.remove("flex");
    modal.classList.add("hidden");
  }, 300);
}
</script>



</body>
</html>
