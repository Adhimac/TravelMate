<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Rent Car — TravelMate</title>
  <link rel="icon" type="image/x-icon" href="favicon.ico">
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
  <style>
    :root {
      --primary: #1e3a8a;
      --accent-start: #ff5a5f;
      --accent-end: #ff9f43;
    }
    .btn-accent {
      background: linear-gradient(90deg, var(--accent-start), var(--accent-end));
      color: white;
      font-weight: 600;
      border-radius: 8px;
      transition: 0.22s;
    }
    .btn-accent:hover { opacity: 0.92; transform: translateY(-2px); }
    .card-shadow { box-shadow: 0 8px 24px rgba(14,30,37,0.06); }
  </style>
</head>
<body class="bg-gray-50 text-gray-800">

  <!-- NAV -->
  <header class="sticky top-0 z-50 bg-white/80 backdrop-blur-md border-b border-gray-100">
    <div class="max-w-6xl mx-auto px-4 flex items-center justify-between h-16">
      <a href="index.html" class="flex items-center gap-3">
        <div class="w-10 h-10 rounded-lg bg-gradient-to-br from-orange-500  to-red-300 flex items-center justify-center text-white font-bold">TM</div>
        <span class="text-lg font-semibold text-[var(--primary)]">TravelMate</span>
      </a>
      <nav class="hidden md:flex gap-6">
        <a href="destination.html" class="hover:text-[var(--primary)]">Destinations</a>
        <a href="rent.html" class="text-[var(--primary)] font-semibold border-b-2 border-[var(--primary)]">Rent a Car</a>
        <a href="driverList.html" class="hover:text-[var(--primary)]">Hire a Driver</a>
      </nav>
    </div>
  </header>

  <!-- HERO -->
  <section class="relative h-40 bg-[url('https://source.unsplash.com/1600x900/?car,travel')] bg-cover bg-center flex items-center">
    <div class="absolute inset-0 bg-black/45"></div>
    <div class="relative max-w-6xl mx-auto px-6 text-white">
      <h1 class="text-2xl md:text-3xl font-extrabold" data-aos="fade-up">Rent — Confirm Booking</h1>
      <p class="text-sm mt-1 text-white/90" data-aos="fade-up" data-aos-delay="80">Complete your booking and confirm payment details.</p>
    </div>
  </section>

  <!-- MAIN -->
  <main class="max-w-6xl mx-auto px-6 py-12 grid grid-cols-1 lg:grid-cols-3 gap-8">
    <!-- Left: Car + Dealer Info -->
    <section class="lg:col-span-2">
      
      <div class="bg-white rounded-2xl p-6 card-shadow" data-aos="fade-up">
        <div class="flex flex-col md:flex-row gap-6">
          <img id="car-image" src="https://source.unsplash.com/500x350/?car" alt="Car" class="w-full md:w-72 h-44 md:h-44 object-cover rounded-lg shadow-sm">
          <div class="flex-1">
            <h2 id="car-name" class="text-2xl font-semibold text-[var(--primary)]">Car Model</h2>
            <p id="dealer-name" class="text-sm text-gray-600 mt-2">Dealer: <span class="font-medium">Dealer Name</span></p>
            <p id="car-meta" class="text-gray-600 mt-3">Type • Seats • Transmission</p>
            <div class="mt-4 flex items-center gap-4">
              <div>
                <div class="text-xs text-gray-500">Price per day</div>
                <div id="price-per-day" class="text-xl font-bold text-[var(--primary)]">₹0</div>
              </div>
              <div class="ml-auto text-sm text-gray-500">Reference: <span id="ref-code">—</span></div>
            </div>
          </div>
        </div>

        <hr class="my-6">

        <!-- Booking form -->
        <form id="rent-form"  method="POST" class="grid grid-cols-1 md:grid-cols-2 gap-4">
          {% csrf_token %}

          
          {% for messages in messages %}
            {{messages}}
          {% endfor %}
            
<!-- 
          <input type="hidden" name="car_id" id="car-id" value="">
          <input type="hidden" name="dealer" id="dealer-field" value="">
          <input type="hidden" name="price_day" id="price-day-field" value="0"> -->

          <div>
            <label class="block text-sm font-medium text-gray-700">Full name</label>
            <input required name="customer_name" id="customer-name" value="{{ us.Name }}" type="text" class="mt-1 w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[var(--primary)]" placeholder="Your full name">
          </div>

          <div>
            <label class="block text-sm font-medium text-gray-700">Phone</label>
            <input required name="phone" id="phone" type="tel" value="{{ us.phoneNumber }}" class="mt-1 w-full border border-gray-300 rounded-lg px-3 py-2" placeholder="+91 98765 43210">
          </div>

          <div>
            <label class="block text-sm font-medium text-gray-700">Pickup location</label>
            <input required name="pickupLocation" id="pickup" type="text" class="mt-1 w-full border border-gray-300 rounded-lg px-3 py-2" placeholder="Pickup address or landmark">
          </div>

          <div>
            <label class="block text-sm font-medium text-gray-700">Drop location</label>
            <input required name="dropLocation" id="drop" type="text" class="mt-1 w-full border border-gray-300 rounded-lg px-3 py-2" placeholder="Destination">
          </div>

          <div>
            <label class="block text-sm font-medium text-gray-700">Start date</label>
            <input required name="startDate" id="start-date" type="date" class="mt-1 w-full border border-gray-300 rounded-lg px-3 py-2">
          </div>

          <div>
            <label class="block text-sm font-medium text-gray-700">End date</label>
            <input required name="endDate" id="end-date" type="date" class="mt-1 w-full border border-gray-300 rounded-lg px-3 py-2">
          </div>

          <div>
            <label class="block text-sm font-medium text-gray-700">Number of days</label>
            <input required name="numberOfDays" id="days" type="number" min="1" value="1" class="mt-1 w-full border border-gray-300 rounded-lg px-3 py-2">
          </div>

          <div>
            <label class="block text-sm font-medium text-gray-700">Preferred time</label>
            <input name="preferredTime" id="time" type="time" class="mt-1 w-full border border-gray-300 rounded-lg px-3 py-2">
          </div>

          <div class="md:col-span-2">
            <label class="block text-sm font-medium text-gray-700">Additional notes</label>
            <textarea name="notes" id="notes" rows="3" class="mt-1 w-full border border-gray-300 rounded-lg px-3 py-2" placeholder="Any special requests or instructions"></textarea>
          </div>

          <!-- Payment options -->
          <!-- <div class="md:col-span-2">
            <label class="block text-sm font-medium text-gray-700 mb-2">Payment method</label>
            <div class="flex items-center gap-4">
              <label class="inline-flex items-center gap-2">
                <input type="radio" name="paymentMethod" value="online" checked>
                <span class="text-sm">Online / Card</span>
              </label>
              <label class="inline-flex items-center gap-2">
                <input type="radio" name="paymentMethod" value="cod">
                <span class="text-sm">Pay on Pickup</span>
              </label>
              <label class="inline-flex items-center gap-2">
                <input type="radio" name="paymentMethod" value="upi">
                <span class="text-sm">UPI</span>
              </label>
            </div>
          </div> -->

          <div class="md:col-span-2 flex items-center justify-between gap-4 mt-2">
            <a href="" class="text-sm text-gray-600 hover:underline">← Back to cars</a>
            <button type="submit" class="btn-accent px-6 py-2">Confirm & Pay</button>
          </div>
        </form>
      </div>
    </section>

    <!-- Right: Pricing summary -->
    <aside class="bg-white rounded-2xl p-6 card-shadow" data-aos="fade-up">
      <h3 class="text-lg font-semibold text-gray-800">Booking Summary</h3>
      <div class="mt-4 space-y-3 text-sm text-gray-700">
        <div class="flex justify-between">
          <span>Car</span><span id="summary-car">—</span>
        </div>
        <div class="flex justify-between">
          <span>Dealer</span><span id="summary-dealer">—</span>
        </div>
        <div class="flex justify-between">
          <span>Price / day</span><span id="summary-price">₹0</span>
        </div>
        <div class="flex justify-between">
          <span>Days</span><span id="summary-days">1</span>
        </div>
        <div class="flex justify-between font-medium">
          <span>Total</span><span id="summary-total">₹0</span>
        </div>
        <div class="text-xs text-gray-500 pt-2">
          Taxes, insurance and extras may be added at checkout.
        </div>
      </div>

      <hr class="my-4">

      <div>
        <label class="flex items-center gap-2 text-sm">
          <input id="agree" type="checkbox" required>
          <span>I agree to the <a href="#" class="text-[var(--primary)] hover:underline">terms & conditions</a>.</span>
        </label>
      </div>
    </aside>
  </main>

  <!-- FOOTER -->
  <footer class="bg-[var(--primary)] text-white py-8 mt-10">
    <div class="max-w-6xl mx-auto px-6 flex flex-col md:flex-row items-center justify-between gap-4">
      <div>
        <div class="font-bold text-lg">TravelMate</div>
        <div class="text-sm text-white/90 mt-1">© 2025 TravelMate. All Rights Reserved.</div>
      </div>
      <div class="flex items-center gap-4 text-sm">
        <a href="#" class="hover:underline">Privacy</a>
        <a href="#" class="hover:underline">Terms</a>
        <a href="#" class="hover:underline">Contact</a>
      </div>
    </div>
  </footer>

  <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
  <script>
    AOS.init({ duration: 700, once: true });

    // Utility: get URL params (e.g. ?car=Honda%20City&dealer=Velocity&price=1800&img=...&ref=CAR123)
    function getParams() {
      const params = new URLSearchParams(location.search);
      const result = {};
      for (const [k, v] of params.entries()) result[k] = v;
      return result;
    }

    // Populate page with params if provided
    (function populateFromParams() {
      const p = getParams();
      const carName = decodeURIComponent(p.car || '') || '{{ car.vehicleName }}';
      const dealer = decodeURIComponent(p.dealer || '') || '{{ car.partner.name }}, {{ car.partner.city }}';
      const price = Number(p.price || p.price_day || '{{ car.rentPerDay }}');
      const img = decodeURIComponent(p.img || '') || '{{ car.vehicleImage.url }}';
      const meta = decodeURIComponent(p.meta || '') || '{{ car.vehicleType }} • {{ car.seatingCapacity }} seats • {{ car.transmission }}';
      const ref = decodeURIComponent(p.ref || '') || 'REF-' + Math.floor(Math.random()*9000 + 1000);

      // DOM
      document.getElementById('car-name').textContent = carName;
      document.getElementById('dealer-name').querySelector('span').textContent = dealer;
      document.getElementById('car-meta').textContent = meta;
      document.getElementById('price-per-day').textContent = price ? `₹${price.toLocaleString()}/day` : '₹0';
      document.getElementById('car-image').src = img;
      document.getElementById('ref-code').textContent = ref;
      document.getElementById('car-id').value = p.id || '';
      document.getElementById('dealer-field').value = dealer;
      document.getElementById('price-day-field').value = price;

      // summary
      document.getElementById('summary-car').textContent = carName;
      document.getElementById('summary-dealer').textContent = dealer;
      document.getElementById('summary-price').textContent = price ? `₹${price.toLocaleString()}` : '₹0';
      updateTotal(); // init
    })();

    // Calculate totals
    function updateTotal() {
      const days = Math.max(1, Number(document.getElementById('days').value || 1));
      const price = Number(document.getElementById('price-day-field').value || 0);
      const total = days * price;
      document.getElementById('summary-days').textContent = days;
      document.getElementById('summary-total').textContent = `₹${total.toLocaleString()}`;
    }

    // Event listeners
    document.getElementById('days').addEventListener('input', updateTotal);
    document.getElementById('start-date').addEventListener('change', () => {
      // optional: auto-calc days from start/end if both provided
      const start = document.getElementById('start-date').value;
      const end = document.getElementById('end-date').value;
      if (start && end) {
        const s = new Date(start);
        const e = new Date(end);
        const diff = Math.ceil((e - s) / (1000*60*60*24)) + 1;
        if (!isNaN(diff) && diff >= 1) {
          document.getElementById('days').value = diff;
          updateTotal();
        }
      }
    });
    document.getElementById('end-date').addEventListener('change', () => {
      const start = document.getElementById('start-date').value;
      const end = document.getElementById('end-date').value;
      if (start && end) {
        const s = new Date(start);
        const e = new Date(end);
        const diff = Math.ceil((e - s) / (1000*60*60*24)) + 1;
        if (!isNaN(diff) && diff >= 1) {
          document.getElementById('days').value = diff;
          updateTotal();
        }
      }
    });

    // Form submission (demo)
    document.getElementById('rent-form').addEventListener('submit', function (ev) {
      ev.preventDefault();
      // Basic client-side validation
      if (!document.getElementById('agree').checked) {
        alert('Please agree to terms & conditions before continuing.');
        return;
      }
      // Collect form data
      const fd = new FormData(this);
      // For real app: send fd via fetch to your backend endpoint
      // Here: show a confirmation modal (simple)
      const name = fd.get('customer_name');
      const total = document.getElementById('summary-total').textContent;
      alert(`Thanks, ${name}!\nYour booking request has been received.\nTotal: ${total}\n(Implement backend POST to process payment & save booking.)`);
      // Optionally redirect to a thank-you page:
      // location.href = '/thank-you.html';
    });

  </script>
</body>
</html>
